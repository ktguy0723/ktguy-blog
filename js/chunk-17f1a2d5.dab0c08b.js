(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17f1a2d5"],{"42fb":function(s,r,t){"use strict";t.r(r);var e=function(){var s=this,r=s.$createElement;s._self._c;return s._m(0)},a=[function(){var s=this,r=s.$createElement,e=s._self._c||r;return e("section",[e("h1",[s._v("vue-realworld-example-appを読んでみた")]),e("h2",[s._v("📌背景")]),e("p",[s._v("この"),e("a",{attrs:{href:"https://github.com/gothinkster/vue-realworld-example-app"}},[s._v("リポジトリ")]),s._v("は、実世界の例（CRUD、認証、高度なパターンなど）を含むVue.jsプロジェクトである。Webアプリケーションの基本的な機能が一通りまとまっている。本記事は、一般的なVue.jsプロジェクトはどのような構成になっているか、どのような技術が使われているかを知るために、この"),e("a",{attrs:{href:"https://github.com/gothinkster/vue-realworld-example-app"}},[s._v("リポジトリ")]),s._v("をソースリーディングしまとめたものである。")]),e("h2",[s._v("📌全体構成の確認")]),e("h3",[s._v("📖フォルダ構成")]),e("p",[e("code",{pre:!0},[s._v("/src")]),s._v("構成は以下の通り。")]),e("ul",[e("li",[e("p",[e("code",{pre:!0},[s._v("/views")])]),e("p",[s._v("router/index.jsでルーティング指定されている各ページを格納している。")])]),e("li",[e("p",[e("code",{pre:!0},[s._v("/router")])]),e("p",[e("strong",[s._v("Vue Router")]),s._v("によるルーティングの設定を行っている。")])]),e("li",[e("p",[e("code",{pre:!0},[s._v("/components")])]),e("p",[s._v("アプリ内で共通で使用する機能を実装する。")])]),e("li",[e("p",[e("code",{pre:!0},[s._v("/store")])]),e("p",[e("strong",[s._v("Vuex")]),s._v("による状態管理を行っている。/views, /components内の.vueファイルから呼ばれる。")])]),e("li",[e("p",[e("code",{pre:!0},[s._v("/common")])]),e("p",[s._v("共通機能がまとまっている。基本的に"),e("code",{pre:!0},[s._v("/store")]),s._v("から呼ばれる。")])]),e("li",[e("p",[e("code",{pre:!0},[s._v("App.vue")]),s._v("、 "),e("code",{pre:!0},[s._v("main.js")])]),e("p",[s._v("アプリのエントリーポイントとなり、アプリ全体の設定などはここで行う。")])])]),e("h3",[s._v("📖コンポーネント構成")]),e("p",[s._v("コンポーネント構成は下記の通りである。**「緑＝/views、黄色＝/components」**である。")]),e("p",[e("img",{attrs:{src:t("db1a"),alt:"constructure"}})]),e("p",[s._v("ある程度リポジトリの全体構成が見えてきた。続いて、1つずつソースコードを見ていく。")]),e("h2",[s._v("📌 ソースコード詳細")]),e("h3",[s._v("📖 main.js、App.vue")]),e("h4",[s._v("🔖 "),e("code",{pre:!0},[s._v("main.js")])]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" DateFilter "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./common/date.filter"')]),s._v(";\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" ErrorFilter "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./common/error.filter"')]),s._v(";\n\nVue.filter("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"date"')]),s._v(", DateFilter);\nVue.filter("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),s._v(", ErrorFilter);\n")])]),e("p",[s._v("アプリ全体で使用する、日付変換（"),e("code",{pre:!0},[s._v("date")]),s._v("）や エラー変換("),e("code",{pre:!0},[s._v("error")]),s._v(")のフィルターはここで定義する。 これらは/commonで定義されている。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" ApiService "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./common/api.service"')]),s._v(";\n\nApiService.init();\n")])]),e("p",[s._v("初期化処理を記載している。 "),e("code",{pre:!0},[s._v("ApiService.init()")]),s._v("では、"),e("code",{pre:!0},[s._v("axios")]),s._v("プラグインを適用し、デフォルトURLを設定している。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { CHECK_AUTH } "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./store/actions.type"')]),s._v(";\n\nrouter.beforeEach("),e("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("to, "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next")]),s._v(") =>")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v(".all([store.dispatch(CHECK_AUTH)]).then(next)\n);\n")])]),e("p",[e("code",{pre:!0},[s._v("router.beforeEach()")]),s._v("はページロードごとに呼ばれる関数。"),e("code",{pre:!0},[s._v("Promise.all()")]),s._v("は、配列を引数にとり、すべてのPromiseを実行する。ここでトークンを用いて認証処理をする。")]),e("h4",[s._v("🔖"),e("code",{pre:!0},[s._v("App.vue")])]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<template>\n  <div id="app">\n    <RwvHeader />\n    <router-view />\n    <RwvFooter />\n  </div>\n</template>\n')])]),e("p",[s._v("ヘッダ、フッタはここで指定する。")]),e("h3",[s._v("📖 / router")]),e("h4",[s._v("🔖"),e("code",{pre:!0},[s._v("index.js")])]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("routes: [\n    {\n        "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/views/Home"')]),s._v("),\n        "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("children")]),s._v(": [\n            {\n                "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v(",\n                "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"home"')]),s._v(",\n                "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/views/HomeGlobal"')]),s._v(")\n            },\n            ...\n   \t\t],\n        ...\n\t},\n    ...\n]\n")])]),e("p",[e("code",{pre:!0},[s._v("children")]),s._v("を使用することで、routerを2段階構成にしている。 上記の例ではHomeの中で使用するHomeGlobalのルートを"),e("code",{pre:!0},[s._v("children")]),s._v("で指定している。 また"),e("code",{pre:!0},[s._v("name")]),s._v("をつけることで、"),e("code",{pre:!0},[s._v("<router-link :to={ name: 'home' }>")]),s._v("と指定できるようになる。")]),e("h3",[s._v("📖 /views")]),e("h4",[s._v("🔖 / views / Home.vue 周辺")]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("Home.vue")])])])]),e("p",[e("code",{pre:!0},[s._v("<router-link>")]),s._v("で HomeGlobal、HomeMyFeed、HomeTag にリンクをはり、 "),e("code",{pre:!0},[s._v("<router-view>")]),s._v("で表示する仕組みになっている。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<script>\nimport { mapGetters } from "vuex";\nimport RwvTag from "@/components/VTag";\nimport { FETCH_TAGS } from "@/store/actions.type";\nexport default {\n  name: "home",\n  components: {\n    RwvTag\n  },\n  mounted() {\n    this.$store.dispatch(FETCH_TAGS);\n  },\n  computed: {\n    ...mapGetters(["isAuthenticated", "tags"]),\n    tag() {\n      return this.$route.params.tag;\n    }\n  }\n};\n<\/script>\n')])]),e("p",[e("code",{pre:!0},[s._v("mounted()")]),s._v("では、またこちらもVuexのactionを使用し、"),e("code",{pre:!0},[s._v("FETCH_TAGS")]),s._v("を実行し、APIから取得した"),e("code",{pre:!0},[s._v("tags")]),s._v("を"),e("code",{pre:!0},[s._v("mapGetter()")]),s._v("で使用できるようにしている。"),e("code",{pre:!0},[s._v("mapGetter()")]),s._v("は引数で指定したstateの値を取得する関数で、computedで使用する。")]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("HomeGlobal.vue")]),s._v(", "),e("code",{pre:!0},[s._v("HomeMyFeed.vue")]),s._v(", "),e("code",{pre:!0},[s._v("HomeTag.vue")])])])]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<template>\n  <div class="home-global"><RwvArticleList type="all" /></div>\n  \x3c!--\n\t<div class="home-my-feed"><RwvArticleList type="feed" /></div>\n  \t<div class="home-tag"><RwvArticleList :tag="tag"></RwvArticleList></div>\n  --\x3e\n</template>\n')])]),e("p",[s._v("templateの中身を見るとどれも似た構成。"),e("code",{pre:!0},[s._v("@/components/ArticleList")]),s._v("を呼び、属性 ( type )を変えているだけ。")]),e("h4",[s._v("🔖/ views / Login.vue , Register.vue, Settings.vue")]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("Login.vue")])])])]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("form")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@submit.prevent")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"onSubmit(email, password)"')]),s._v(">")]),s._v("\n...\n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("form")]),s._v(">")]),s._v("\n")])]),e("p",[s._v("v-modelでバインディングして、ボタン押下すると値が送信される一般的なフォームの実装となっている。"),e("code",{pre:!0},[s._v("@submit.prevent")]),s._v("は"),e("code",{pre:!0},[s._v("event.preventDefault()")]),s._v("を呼び出す処理。これをつけることでフォーム送信後もページのリロードを行わないようにする。"),e("code",{pre:!0},[s._v(".prevent")]),s._v("はイベント修飾子と呼ばれる。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { mapState } "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vuex"')]),s._v(";\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { LOGIN } "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/store/actions.type"')]),s._v(";\n\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  ...\n  data() {\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n      "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("email")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(",\n      "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("password")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n    };\n  },\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    onSubmit(email, password) {\n      "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$store\n        .dispatch(LOGIN, { email, password })\n        .then("),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$router.push({ "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"home"')]),s._v(" }));\n    }\n  },\n  ...\n}; \n")])]),e("p",[s._v("ログインが成功したら、"),e("code",{pre:!0},[s._v('.then(() => { this.$router.push({ name: "home" })});')]),s._v("を行い、ホームに飛ばす処理が入っているのがみそ。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { mapState } "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vuex"')]),s._v(";\n\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  ...\n  computed: {\n    "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// auth.errors を errors に代入する処理。")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ↓ 加工後の名称: state => 加工処理(state.加工対象のステート名)")]),s._v("\n    ...mapState({\n      "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("errors")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("state")]),s._v(" =>")]),s._v(" state.auth.errors\n    })\n  }\n};\n")])]),e("p",[s._v("上記の書き方は、stateを加工した結果をバインドする方法。")]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("Register.vue")])])])]),e("p",[e("code",{pre:!0},[s._v("Login.vue")]),s._v("とほぼ同じ構成。違いは、フォームに"),e("code",{pre:!0},[s._v("username")]),s._v("の欄ができて、Vuex.actionの呼び出しが、"),e("code",{pre:!0},[s._v("LOGIN")]),s._v("から"),e("code",{pre:!0},[s._v("REGISTER")]),s._v("になったくらい。")]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("Setting.vue")])])])]),e("p",[e("code",{pre:!0},[s._v("Login.vue")]),s._v("や"),e("code",{pre:!0},[s._v("Register.vue")]),s._v("とほぼ同じ構成。")]),e("h4",[s._v("🔖/ views / Profile.vue 周辺")]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("Profile.vue")])])])]),e("p",[e("code",{pre:!0},[s._v("<router-link>")]),s._v("で ProfileArticles、ProfileFavorited にリンクをはり、 "),e("code",{pre:!0},[s._v("<router-view>")]),s._v("で表示する仕組みになっている。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<div v-if="isCurrentUser()">\n  <router-link\n    class="btn btn-sm btn-outline-secondary action-btn"\n    :to="{ name: \'settings\' }"\n  >\n    ...\n  </router-link>\n</div>\n<div v-else>\n  <button\n    class="btn btn-sm btn-secondary action-btn"\n    v-if="profile.following"\n    @click.prevent="unfollow()"\n  >\n    ...\n  </button>\n  <button\n    class="btn btn-sm btn-outline-secondary action-btn"\n    v-if="!profile.following"\n    @click.prevent="follow()"\n  >\n    ...\n  </button>\n</div>\n')])]),e("p",[e("code",{pre:!0},[s._v('<div v-if="isCurrentUser()">')]),s._v("でログイン中のユーザかどうかで表示画面が変わる。 "),e("code",{pre:!0},[s._v('v-if="profile.following"')]),s._v("部分も同様で、フォローしているかどうかで表示画面が変わる。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" {\n  FETCH_PROFILE,\n  FETCH_PROFILE_FOLLOW,\n  FETCH_PROFILE_UNFOLLOW\n} "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/store/actions.type"')]),s._v(";\n\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  ...\n  mounted() {\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$store.dispatch(FETCH_PROFILE, "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$route.params);\n  },\n  ...\n  watch: {\n    $route(to) {\n      "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$store.dispatch(FETCH_PROFILE, to.params);\n    }\n  }\n};      \n\n")])]),e("p",[s._v("初期化時に"),e("code",{pre:!0},[s._v("mounted()")]),s._v("で、ページのユーザ名をルートのパラメータから取得する。")]),e("p",[s._v("Vue.jsではパラメータが "),e("code",{pre:!0},[s._v("#/@hoge")]),s._v(" から "),e("code",{pre:!0},[s._v("#/@huga")]),s._v(" へ遷移するときに"),e("strong",[s._v("同じコンポーネントインスタンスが再利用される")]),s._v("ので"),e("code",{pre:!0},[s._v("watch: $route(to){...}")]),s._v("を使用して、パラメータの検地をおこなっている。"),e("a",{attrs:{href:"https://router.vuejs.org/ja/guide/essentials/dynamic-matching.html#%E3%83%8F%E3%82%9A%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E5%A4%89%E6%9B%B4%E3%81%AE%E6%A4%9C%E7%9F%A5"}},[s._v("参考")])]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("ProfileArticles.vue")]),s._v("、"),e("code",{pre:!0},[s._v("ProfileFavorited.vue")])])])]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<template>\n  <div class="profile-page">\n    <RwvArticleList :author="author" :items-per-page="5"></RwvArticleList>\n    \x3c!--\n    <RwvArticleList :favorited="favorited" :items-per-page="5">\n    </RwvArticleList>\n    --\x3e\n  </div>\n</template>\n')])]),e("p",[s._v("templateの中身を見るとどれも似た構成。"),e("code",{pre:!0},[s._v("@/components/ArticleList")]),s._v("を呼び、属性 ( author, favorited )を変えているだけ。")]),e("h4",[s._v("🔖/ views / Article.vue")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" store "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/store"')]),s._v(";\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { FETCH_ARTICLE, FETCH_COMMENTS } "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/store/actions.type"')]),s._v(";\n\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//...")]),s._v("\n  beforeRouteEnter(to, "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next) {\n    "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v(".all([\n      store.dispatch(FETCH_ARTICLE, to.params.slug),\n      store.dispatch(FETCH_COMMENTS, to.params.slug)\n    ]).then("),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n      next();\n    });\n  }\n  "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//...")]),s._v("\n}\n")])]),e("p",[e("code",{pre:!0},[s._v("beforeRouteEnter()")]),s._v("を用いて、"),e("code",{pre:!0},[s._v("FETCH_ARTICLE")]),s._v("、"),e("code",{pre:!0},[s._v("FETCH_COMMENTS")]),s._v("を呼び、articleとcommentの最新のものを取得しstateを更新する。"),e("a",{attrs:{href:"https://router.vuejs.org/ja/guide/advanced/navigation-guards.html#%E3%83%AB%E3%83%BC%E3%83%88%E5%8D%98%E4%BD%8D%E3%82%AB%E3%82%99%E3%83%BC%E3%83%88%E3%82%99"}},[s._v("参考")])]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-html")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"parseMarkdown(article.body)"')]),s._v(">")]),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n")])]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" marked "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"marked"')]),s._v(";\n"),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    parseMarkdown(content) {\n      "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" marked(content);\n    }\n  }\n}\n")])]),e("p",[e("code",{pre:!0},[s._v("marked()")]),s._v("はマークダウン解析ツール、htmlを返すため、"),e("code",{pre:!0},[s._v("v-html")]),s._v("ディレクティブを使用している。")]),e("h4",[s._v("🔖/ views / ArticleEdit.vue")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("  "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// /editor/:slug => /editor の場合、エディタを空にして表示する。")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" beforeRouteUpdate(to, "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next) {\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" store.dispatch(ARTICLE_RESET_STATE);\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" next();\n  },\n  "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// /editorの場合は下記のifがfalseになり、実行される。")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// /editor/:slug の場合は下記のifがtrueになり、実行される。 ")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" beforeRouteEnter(to, "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next) {\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" store.dispatch(ARTICLE_RESET_STATE);\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (to.params.slug !== "),e("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("undefined")]),s._v(") {\n      "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" store.dispatch(\n        FETCH_ARTICLE,\n        to.params.slug,\n        to.params.previousArticle\n      );\n    }\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" next();\n  },\n  "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// /editor/:slug から去るときエディタを空にする。")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" beforeRouteLeave(to, "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next) {\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" store.dispatch(ARTICLE_RESET_STATE);\n    next();\n  },\n")])]),e("p",[s._v("ナビゲーションガードで制御する。記事エディタを空に更新するが、/editor/slugのように、ArticleEditにアクセスする場合は、元記事が記載されたままで表示する。")]),e("p",[s._v("※ ちなみに上記のナビゲーションガードは、パラメータが変わったタイミングでは実行されないので、 "),e("code",{pre:!0},[s._v("/editor")]),s._v(" から"),e("code",{pre:!0},[s._v("/editor/:slug")]),s._v("に遷移した場合、元記事が記載されない。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<template>\n   ... \n  <input\n       type="text"\n       class="form-control"\n       placeholder="Enter tags"\n       v-model="tagInput"\n       @keypress.enter.prevent="addTag(tagInput)"\n    />\n  <div class="tag-list">\n    <span\n      class="tag-default tag-pill"\n      v-for="(tag, index) of article.tagList"\n      :key="tag + index"\n    >\n \t  <i class="ion-close-round" @click="removeTag(tag)"> </i>\n      {{ tag }}\n\t</span>\n  </div>\n  ...\n</template>\n')])]),e("p",[s._v("タグの登録処理は、"),e("code",{pre:!0},[s._v('@keypress.enter.prevent="addTag(tagInput)"')]),s._v("でエンター押下時にタグ登録処理を行う実装となっている。")]),e("h3",[s._v("📖 /components")]),e("h4",[s._v("🔖/ components / TheHeader.vue")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ul")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-if")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"!isAuthenticated"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"nav navbar-nav pull-xs-right"')]),s._v(">")]),s._v("\n  ....    \n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ul")]),s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ul")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-else")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"nav navbar-nav pull-xs-right"')]),s._v(">")]),s._v("\n  ....\n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ul")]),s._v(">")]),s._v("\n")])]),e("p",[s._v("認証状態によって表示する画面を"),e("code",{pre:!0},[s._v("v-if")]),s._v("で切り替えている。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("router-link")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"nav-link"')]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("active-class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"active"')]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("exact")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":to")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("\"{\n    name: 'profile',\n    params: { username: currentUser.username }\n   }\"")]),s._v("\n>")]),s._v("\n  {{ currentUser.username }}\n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("router-link")]),s._v(">")]),s._v("\n")])]),e("p",[e("code",{pre:!0},[s._v("<router-link>")]),s._v("では"),e("code",{pre:!0},[s._v(":to=params:{...}")]),s._v("でパラメータを指定することができる。")]),e("h4",[s._v("🔖 / components / VTag.vue")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("router-link")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":to")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"homeRoute"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"className"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-text")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"name"')]),s._v(">")]),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("router-link")]),s._v(">")]),s._v("\n")])]),e("p",[e("code",{pre:!0},[s._v('v-text="name"')]),s._v("は"),e("code",{pre:!0},[s._v("{{ name }}")]),s._v("と同じ")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" { \n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("props")]),s._v(": {\n    "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": {\n      "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("String")]),s._v(",\n      "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("required")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n    },\n    "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("className")]),s._v(": {\n      "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("String")]),s._v(",\n      "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("default")]),s._v(": "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"tag-pill tag-default"')]),s._v("\n    }\n  }\n  "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n}\n")])]),e("p",[e("code",{pre:!0},[s._v("props")]),s._v("にて、型の指定（type）、必須項目指定（required）、デフォルト値（default）を指定できる。以降で説明するコンポーネントの"),e("code",{pre:!0},[s._v("props")]),s._v("においても、型の指定などを必ず行っていた。")]),e("h4",[s._v("🔖 / components / ArticleMeta.vue 周辺")]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("ArticleMeta.vue")])])])]),e("p",[s._v("記事作成者の情報などで構成されるコンポーネント。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"date"')]),s._v(">")]),s._v("{{ article.createdAt | date }}"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n")])]),e("p",[s._v("main.jsで定義したフィルターが使用されていることを確認。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("rwv-article-actions")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-if")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"actions"')]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":article")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"article"')]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":canModify")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"isCurrentUser()"')]),s._v("\n>")]),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("rwv-article-actions")]),s._v(">")]),s._v("\n")])]),e("p",[s._v("フォロー、いいねボタンはArticleActionsコンポーネントで制御している。")]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("ArtcleAction.vue")])])])]),e("p",[s._v("親コンポーネント：ArticleMeta")]),e("p",[s._v("フォローやいいねボタンを構成するコンポーネント")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-if")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"canModify"')]),s._v(">")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!-- Edit Article, DeleteArticleボタンが表示 --\x3e")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-else")]),s._v(">")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!-- Follow, Favoriteボタンが表示 --\x3e")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n")])]),e("p",[s._v("著者か否かで表示画面を変えている。")]),e("p",[s._v("また、classを変えるなどの見た目の変更はcomputed, ボタン押下時の処理はmethodsで行う。")]),e("h4",[s._v("🔖 / components / CommentEditor.vue 周辺")]),e("ul",[e("li",[s._v("**`CommentEditor.vue")])]),e("p",[s._v("記事に対するコメントフォームを構成するコンポーネント")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("RwvListErrors")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":errors")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"errors"')]),s._v(" />")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("form")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"card comment-form"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@submit.prevent")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"onSubmit(slug, comment)"')]),s._v(">")]),s._v("\n")])]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("methods: {\n  onSubmit(slug, comment) {\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$store\n      .dispatch(COMMENT_CREATE, { slug, comment })\n      .then("),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n         "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".comment = "),e("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(";\n         "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".errors = {};\n      })\n      .catch("),e("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ response }")]),s._v(") =>")]),s._v(" {\n        "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".errors = response.data.errors;\n      });\n  }\n}\n")])]),e("p",[s._v("フォームのPostボタンを押下すると、"),e("code",{pre:!0},[s._v("COMMENT_CREATE")]),s._v("が実行される。この処理が失敗すると、"),e("code",{pre:!0},[s._v("RwvListErrors")]),s._v("部分でエラーメッセージが表示される。")]),e("ul",[e("li",[s._v("**`ListError.vue")])]),e("p",[s._v("errorsオブジェクトを受け取った時に、エラーメッセージを画面に表示させるコンポーネント。")]),e("h4",[s._v("🔖 / components / Comment.vue")]),e("p",[s._v("親コンポーネント：Article")]),e("p",[s._v("コメント表示のコンポーネント。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-if")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"isCurrentUser"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"mod-options"')]),s._v(">")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("i")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ion-trash-a"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"destroy(slug, comment.id)"')]),s._v(">")]),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("i")]),s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n")])]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("computed: {\n  isCurrentUser() {\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".currentUser.username && "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".comment.author.username) {\n      "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".comment.author.username === "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".currentUser.username;\n    }\n    "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(";\n  },\n  "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n}\n")])]),e("p",[s._v("コメントを削除する部分。"),e("code",{pre:!0},[s._v("isCurretntUser")]),s._v("が現在のユーザと著者が同じ場合は表示する。")]),e("h4",[s._v("🔖 / components / ListErrors.vue")]),e("p",[s._v("errorsオブジェクトを受け取った時に、エラーメッセージを画面に表示させるコンポーネント。"),e("code",{pre:!0},[s._v("CommentEditor.vue")]),s._v("でも使用している。")]),e("h4",[s._v("🔖 / components / ArticleList.vue")]),e("p",[s._v("記事プレビュー一覧を表示するコンポーネント。")]),e("p",[s._v("大まかな処理は、"),e("code",{pre:!0},[s._v("listConfig")]),s._v("に記事情報を持たせて、"),e("code",{pre:!0},[s._v("currentpage")]),s._v(", "),e("code",{pre:!0},[s._v("type")]),s._v(", "),e("code",{pre:!0},[s._v("author")]),s._v(", "),e("code",{pre:!0},[s._v("tag")]),s._v(", "),e("code",{pre:!0},[s._v("favorited")]),s._v("（"),e("code",{pre:!0},[s._v("watch")]),s._v("で監視）に変更があったら、"),e("code",{pre:!0},[s._v("fetchArticle()")]),s._v("で新しい記事を取得する流れである。")]),e("h4",[s._v("🔖 / components / VArticlePreview.vue 周辺")]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("VArticlePreview.vue")])])])]),e("p",[s._v("記事プレビューを表示するコンポーネント。")]),e("p",[s._v("ArticleMeta.vueとTagList.vueコンポーネントを使用している。")]),e("ul",[e("li",[e("strong",[e("code",{pre:!0},[s._v("TagList.vue")])])])]),e("p",[s._v("タグ一覧を表示するコンポーネント。")]),e("h4",[s._v("🔖 / components / VPagination.vue")]),e("p",[s._v("ページ割りの表示をするコンポーネント。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-for")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"page in pages"')]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":data-test")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"`page-link-${page}`"')]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":key")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"page"')]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"paginationClass(page)"')]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click.prevent")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"changePage(page)"')]),s._v("\n>")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"page-link"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("href")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-text")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"page"')]),s._v(" />")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v(">")]),s._v("\n")])]),e("p",[e("code",{pre:!0},[s._v(':class="paginationClass(page)"')]),s._v("で現在のページと一致していたらactive-classをつけ、表示を変える。")]),e("p",[s._v("ページ割りのボタンが押下されたら、"),e("code",{pre:!0},[s._v('@click.prevent="changePage(page)"')]),s._v("を実行する。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("changePage(goToPage) {\n  "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (goToPage === "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".currentPage) "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(";\n  "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$emit("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"update:currentPage"')]),s._v(", goToPage);\n},\n")])]),e("p",[s._v("親コンポーネント（"),e("code",{pre:!0},[s._v("ArticleList.vue")]),s._v("）では、以下のように呼んでいる。")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("VPagination")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":pages")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"pages"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":currentPage.sync")]),s._v("="),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"currentPage"')]),s._v(" />")]),s._v("\n")])]),e("p",[e("code",{pre:!0},[s._v(".sync")]),s._v("修飾子をつけることで、子コンポーネントから"),e("code",{pre:!0},[s._v("this.$emit('update:currentPage', goToPage)")]),s._v(" で親に通知することができる。（親は "),e("code",{pre:!0},[s._v("update:prop名")]),s._v("のイベントを監視) "),e("a",{attrs:{href:"https://jp.vuejs.org/v2/guide/components-custom-events.html#sync-%E4%BF%AE%E9%A3%BE%E5%AD%90"}},[s._v("参照1【Vue】知っておきたい .sync修飾子のすゝめ")]),s._v("、"),e("a",{attrs:{href:"https://jp.vuejs.org/v2/guide/components-custom-events.html#sync-%E4%BF%AE%E9%A3%BE%E5%AD%90"}},[s._v("参考2_公式")])]),e("h3",[s._v("📖 /store")]),e("h4",[s._v("🔖 / store / index.js")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" Vue "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue"')]),s._v(";\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" Vuex "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vuex"')]),s._v(";\n\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" home "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./home.module"')]),s._v(";\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" auth "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./auth.module"')]),s._v(";\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" article "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./article.module"')]),s._v(";\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" profile "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./profile.module"')]),s._v(";\n\nVue.use(Vuex);\n\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Vuex.Store({\n  "),e("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("modules")]),s._v(": {\n    home,\n    auth,\n    article,\n    profile\n  }\n});\n")])]),e("p",[s._v("ストアオブジェクトを複数のファイルで管理するために、"),e("code",{pre:!0},[s._v("modules")]),s._v("を使って分割を行う。")])])}],p=t("2877"),n={},v=Object(p["a"])(n,e,a,!1,null,null,null);r["default"]=v.exports},db1a:function(s,r,t){s.exports=t.p+"img/constructure.drawio.29364b59.svg"}}]);
//# sourceMappingURL=chunk-17f1a2d5.dab0c08b.js.map