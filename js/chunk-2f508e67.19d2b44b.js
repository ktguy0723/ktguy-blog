(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f508e67"],{5173:function(s,e,r){s.exports=r.p+"img/constructure.drawio.4b037e4b.svg"},"644d":function(s,e,r){s.exports=r.p+"img/vuex.drawio.7226d5d1.svg"},ceed:function(s,e,r){"use strict";r.r(e);var t=function(){var s=this,e=s.$createElement;s._self._c;return s._m(0)},a=[function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("section",[t("h1",[s._v("vue-realworld-example-appを読んでみた")]),t("p",[s._v("コードリーディングを行ったリポジトリはこちらです。")]),t("p",[t("a",{attrs:{href:"https://github.com/gothinkster/vue-realworld-example-app"}},[s._v("gothinkster/vue-realworld-example-app")]),t("a",{attrs:{href:"https://codesandbox.io/s/github/gothinkster/vue-realworld-example-app/tree/master"}},[s._v("codesandbox")])]),t("h4",[s._v("更新履歴")]),t("p",[s._v("2021/6/15 誤字脱字の修正、わかりにくい表現の見直し。全体的な内容の追加。 2021/6/13 初版")]),t("h2",[s._v("📌はじめに")]),t("h3",[s._v("📖 記事の背景")]),t("p",[t("a",{attrs:{href:"https://github.com/gothinkster/vue-realworld-example-app"}},[t("strong",[s._v("vue-realworld-example-app")])]),s._v(" は、実際のアプリで使用する機能（CRUD、認証、ルーティングなど）を盛り込んだVue.jsプロジェクトである。Webアプリケーションの基本的な機能が一通りまとまっている。")]),t("p",[s._v("本記事は、一般的なVue.jsプロジェクトはどのような構成になっているか、どのような技術が使われているかを知るために、"),t("a",{attrs:{href:"https://github.com/gothinkster/vue-realworld-example-app"}},[t("strong",[s._v("vue-realworld-example-app")])]),s._v(" をコードリーディングし、まとめたものである。")]),t("h3",[s._v("📖 ( 参考 前提知識 )")]),t("p",[s._v("コードリーディングを行うにあたる前提知識として、以下が必要と感じた。")]),t("ul",[t("li",[s._v("Vue.js v2 （Router、Vuex）の基礎知識")]),t("li",[s._v("Vue CLI の基礎知識")])]),t("p",[s._v("また、知っているとよいと感じた知識は以下。（調べながらで読めると思います）")]),t("ul",[t("li",[s._v("REST API の基礎知識")]),t("li",[s._v("JWTの基礎知識")]),t("li",[s._v("ローカルストレージの基礎知識")])]),t("h2",[s._v("📌全体構成の確認")]),t("h3",[s._v("📖フォルダ構成")]),t("p",[t("code",{pre:!0},[s._v("/src")]),s._v("構成と役割は以下の通り。")]),t("ul",[t("li",[t("code",{pre:!0},[s._v("App.vue")]),s._v("、 "),t("code",{pre:!0},[s._v("main.js")]),s._v(" アプリのエントリーポイント。アプリ全体の設定などはここで行う。")]),t("li",[t("code",{pre:!0},[s._v("/views")]),s._v(" 表示する画面のコンポーネントを管理する。ルーティングと対応している。")]),t("li",[t("code",{pre:!0},[s._v("/router")]),s._v(" Vue Routerによるルーティングの設定を行っている。")]),t("li",[t("code",{pre:!0},[s._v("/components")]),s._v(" アプリ内で使用するコンポーネントを管理する。")]),t("li",[t("code",{pre:!0},[s._v("/store")]),s._v(" 状態管理を行うVuexのフォルダ。/views, /components内のから呼ばれる。")]),t("li",[t("code",{pre:!0},[s._v("/common")]),s._v(" API、JWT、フィルタ、設定などのアプリ全体で使用する共通機能。")])]),t("h3",[s._v("📖データの流れ（参考）")]),t("p",[s._v("フォルダのアクセスする流れを整理した。わかりにくいかもしれないので参考までに。")]),t("p",[t("img",{attrs:{src:r("e73d"),alt:"flow"}})]),t("h3",[s._v("📖コンポーネント構成")]),t("p",[s._v("コンポーネント構成は下記の通り。**「緑＝/views、黄色＝/components」**である。"),t("code",{pre:!0},[s._v("/ruter")]),s._v("でルーティングされているコンポーネントは"),t("code",{pre:!0},[s._v("/views")]),s._v("に、それ以外は"),t("code",{pre:!0},[s._v("/components")]),s._v("で管理している。")]),t("p",[t("img",{attrs:{src:r("5173"),alt:"constructure"}})]),t("h3",[s._v("📖 /store, /commonの構成")]),t("p",[t("code",{pre:!0},[s._v("/store")]),s._v(", "),t("code",{pre:!0},[s._v("/common")]),s._v("の関係性は下記のとおり。")]),t("p",[t("code",{pre:!0},[s._v("/store")]),s._v("は、4つのモジュールを"),t("code",{pre:!0},[s._v("export")]),s._v(" している。それぞれのモジュールは、"),t("code",{pre:!0},[s._v("state")]),s._v(", "),t("code",{pre:!0},[s._v("getters")]),s._v(", "),t("code",{pre:!0},[s._v("actions")]),s._v(", "),t("code",{pre:!0},[s._v("mutations")]),s._v("を持ち、状態管理を行う。状態管理を行う中で、インターフェースのような役割を果たす"),t("code",{pre:!0},[s._v("type")]),s._v("から関数名を参照したり、共通処理を"),t("code",{pre:!0},[s._v("/common")]),s._v("を参照し、実行している。")]),t("p",[t("code",{pre:!0},[s._v("/common")]),s._v("は、"),t("code",{pre:!0},[s._v("/store")]),s._v("で使用する共通処理ファイル（.service.js）とその設定ファイル（config.js）、アプリ全体で使用するフィルターファイル（.filter.js）を持つ。")]),t("p",[t("img",{attrs:{src:r("644d"),alt:"vuex"}})]),t("h2",[s._v("📌 ソースコード詳細")]),t("p",[s._v("各ソースコードの気になったところを抜粋して解説する。 https://github.com/gothinkster/vue-realworld-example-app")]),t("h3",[s._v("📖 main.js、App.vue")]),t("h4",[s._v("🔖 main.js")]),t("p",[t("strong",[s._v("フィルターの定義")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" DateFilter "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./common/date.filter"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" ErrorFilter "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./common/error.filter"')]),s._v(";\n\nVue.filter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"date"')]),s._v(", DateFilter);\nVue.filter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),s._v(", ErrorFilter);\n")])]),t("p",[s._v("アプリ全体で使用する日付変換（"),t("code",{pre:!0},[s._v("DateFilter")]),s._v("）や エラー変換("),t("code",{pre:!0},[s._v("ErrorFilter")]),s._v(")のフィルターはここで設定する。フィルターそのものの定義は"),t("code",{pre:!0},[s._v("/common")]),s._v("でしている。")]),t("p",[t("strong",[s._v("API処理の初期化")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" ApiService "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./common/api.service"')]),s._v(";\n\nApiService.init();\n")])]),t("p",[s._v("サーバとのHTTP通信のための初期化を行う。 "),t("code",{pre:!0},[s._v("ApiService.init()")]),s._v("では、"),t("code",{pre:!0},[s._v("vue-axios")]),s._v("プラグインを適用し、デフォルトURLの設定をしている。")]),t("p",[t("strong",[s._v("ページロードごとの認証処理")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { CHECK_AUTH } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./store/actions.type"')]),s._v(";\n\nrouter.beforeEach("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("to, "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next")]),s._v(") =>")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v(".all([store.dispatch(CHECK_AUTH)]).then(next)\n);\n")])]),t("p",[t("code",{pre:!0},[s._v("router.beforeEach()")]),s._v("はページロードごとに呼ばれる関数。"),t("code",{pre:!0},[s._v("Promise.all()")]),s._v("は、配列を引数にとり、すべてのPromiseを実行する。 ページロードごとにトークンの認証処理をしている。")]),t("p",[t("a",{attrs:{href:"https://router.vuejs.org/ja/guide/advanced/navigation-guards.html#%E3%82%AF%E3%82%99%E3%83%AD%E3%83%BC%E3%83%8F%E3%82%99%E3%83%AB%E3%83%92%E3%82%99%E3%83%95%E3%82%A9%E3%83%BC%E3%82%AB%E3%82%99%E3%83%BC%E3%83%88%E3%82%99"}},[s._v("参考 Vue公式 ナビゲーションガード")])]),t("p",[t("a",{attrs:{href:"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Promise/all"}},[s._v("参考 MDN Promise.all()")])]),t("h4",[s._v("🔖 App.vue")]),t("p",[t("strong",[s._v("ヘッダ、フッタコンポーネントの使用")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<template>\n  <div id="app">\n    <RwvHeader />\n    <router-view />\n    <RwvFooter />\n  </div>\n</template>\n')])]),t("p",[s._v("ヘッダ、フッタはアプリ全体で表示するため、ここで使用する。")]),t("h3",[s._v("📖 / router")]),t("h4",[s._v("🔖 index.js")]),t("p",[t("strong",[s._v("childrenによるネストルーティング")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("routes: [\n    {\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/views/Home"')]),s._v("),\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("children")]),s._v(": [\n            {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"home"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/views/HomeGlobal"')]),s._v(")\n            },\n            ...\n   \t\t],\n        ...\n\t},\n    ...\n]\n")])]),t("p",[t("code",{pre:!0},[s._v("children")]),s._v("を使用することで、ネストされたルートとなる。 また"),t("code",{pre:!0},[s._v("name")]),s._v("をつけることで、"),t("code",{pre:!0},[s._v("<router-link :to={ name: 'home' }>")]),s._v("と指定できる。")]),t("p",[s._v("https://router.vuejs.org/ja/guide/essentials/nested-routes.html")]),t("p",[s._v("https://router.vuejs.org/ja/api/#to")]),t("h3",[s._v("📖 /views")]),t("h4",[s._v("🔖 / views / Home.vue 周辺")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("Home.vue")])])])]),t("p",[t("strong",[s._v("ルーティング概要")])]),t("p",[t("code",{pre:!0},[s._v("<router-link>")]),s._v("で "),t("code",{pre:!0},[s._v("HomeGlobal")]),s._v("、"),t("code",{pre:!0},[s._v("HomeMyFeed")]),s._v("、"),t("code",{pre:!0},[s._v("HomeTag")]),s._v(" に飛ばすリンクを設定し、 "),t("code",{pre:!0},[s._v("<router-view>")]),s._v("で表示する仕組み。")]),t("p",[t("strong",[s._v("データ（tag）の流れ")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<script>\nimport { mapGetters } from "vuex";\nimport { FETCH_TAGS } from "@/store/actions.type";\n    \nexport default {\n  // ...\n  mounted() {\n    this.$store.dispatch(FETCH_TAGS);\n  },\n  computed: {\n    ...mapGetters(["isAuthenticated", "tags"]),\n    tag() {\n      return this.$route.params.tag;\n    }\n  }\n};\n<\/script>\n')])]),t("p",[t("code",{pre:!0},[s._v("mounted()")]),s._v("はVuexの"),t("code",{pre:!0},[s._v("action")]),s._v("を使用して"),t("code",{pre:!0},[s._v("FETCH_TAGS")]),s._v("を実行し、サーバから"),t("code",{pre:!0},[s._v("tags")]),s._v("を取得する。取得した"),t("code",{pre:!0},[s._v("tags")]),s._v("は、Vuexの"),t("code",{pre:!0},[s._v("state")]),s._v("で管理されるので、"),t("code",{pre:!0},[s._v("mapGetter()")]),s._v("で取得し、コンポーネント内で使用している。")]),t("p",[t("code",{pre:!0},[s._v("mapGetters()")]),s._v("は引数で指定した"),t("code",{pre:!0},[s._v("state")]),s._v("の値を取得する関数。"),t("code",{pre:!0},[s._v('import {mapGetters} from "vue"')]),s._v("を使用してインポートし、"),t("code",{pre:!0},[s._v("computed")]),s._v("で使用する。")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("HomeGlobal.vue")]),s._v(", "),t("code",{pre:!0},[s._v("HomeMyFeed.vue")]),s._v(", "),t("code",{pre:!0},[s._v("HomeTag.vue")])])])]),t("p",[t("strong",[s._v("template構成")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<template>\n  <div class="home-global"><RwvArticleList type="all" /></div>\n  \x3c!--\n\t<div class="home-my-feed"><RwvArticleList type="feed" /></div>\n  \t<div class="home-tag"><RwvArticleList :tag="tag"></RwvArticleList></div>\n  --\x3e\n</template>\n')])]),t("p",[s._v("上記3つの"),t("code",{pre:!0},[s._v("<template>")]),s._v("はどれも似た構成。"),t("code",{pre:!0},[s._v("@/components/ArticleList.vue")]),s._v("を属性 ( type )を変えて使用している。")]),t("h4",[s._v("🔖/ views / Login.vue , Register.vue, Settings.vue")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("Login.vue")])])])]),t("p",[t("strong",[s._v("フォームとsubmit ボタン")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("form")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@submit.prevent")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"onSubmit(email, password)"')]),s._v(">")]),s._v("\n...\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("form")]),s._v(">")]),s._v("\n")])]),t("p",[t("code",{pre:!0},[s._v("v-model")]),s._v("でバインディングして、ボタン押下すると値が送信されるごくごく一般的なフォームの実装となっている。"),t("code",{pre:!0},[s._v("@submit.prevent")]),s._v("は"),t("code",{pre:!0},[s._v("event.preventDefault()")]),s._v("を呼び出す処理。これにより、フォーム送信後もページのリロードは行われない。"),t("code",{pre:!0},[s._v(".prevent")]),s._v("は"),t("strong",[s._v("イベント修飾子")]),s._v("と呼ばれる。")]),t("p",[s._v("https://jp.vuejs.org/v2/guide/events.html#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E4%BF%AE%E9%A3%BE%E5%AD%90")]),t("p",[t("strong",[s._v("ログイン成功時、ホーム画面へ")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { mapState } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vuex"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { LOGIN } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/store/actions.type"')]),s._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  ...\n  data() {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n      "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("email")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(",\n      "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("password")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n    };\n  },\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    onSubmit(email, password) {\n      "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$store\n        .dispatch(LOGIN, { email, password })\n        .then("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$router.push({ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"home"')]),s._v(" }));\n    }\n  },\n  ...\n}; \n")])]),t("p",[s._v("ログインに成功したら、"),t("code",{pre:!0},[s._v('.then(() => { this.$router.push({ name: "home" })});')]),s._v("を行い、ホームに飛ばす処理となっている。")]),t("p",[t("strong",[s._v("state の加工")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { mapState } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vuex"')]),s._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  ...\n  computed: {\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// auth.errors を errors に代入する処理。")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ↓ 加工後の名称: state => 加工処理(state.加工対象のステート名)")]),s._v("\n    ...mapState({\n      "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("errors")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("state")]),s._v(" =>")]),s._v(" state.auth.errors\n    })\n  }\n};\n")])]),t("p",[s._v("上記は"),t("code",{pre:!0},[s._v("auth.errors")]),s._v(" を "),t("code",{pre:!0},[s._v("errors")]),s._v(" に代入する処理。")]),t("p",[s._v("https://qiita.com/suin/items/7331905a45a8ff80d4dd#seven-%E3%82%B9%E3%83%86%E3%83%BC%E3%83%88%E5%8A%A0%E5%B7%A5%E7%B5%90%E6%9E%9C%E3%81%AE%E3%83%90%E3%82%A4%E3%83%B3%E3%83%89")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("Register.vue")])])])]),t("p",[t("code",{pre:!0},[s._v("Login.vue")]),s._v("とほぼ同じ構成。違いは、フォームに"),t("code",{pre:!0},[s._v("username")]),s._v("の欄ができて、Vuexの"),t("code",{pre:!0},[s._v("action")]),s._v("が、"),t("code",{pre:!0},[s._v("LOGIN")]),s._v("から"),t("code",{pre:!0},[s._v("REGISTER")]),s._v("になったくらい。")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("Setting.vue")])])])]),t("p",[t("code",{pre:!0},[s._v("Login.vue")]),s._v("や"),t("code",{pre:!0},[s._v("Register.vue")]),s._v("とほぼ同じ構成。")]),t("h4",[s._v("🔖/ views / Profile.vue 周辺")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("Profile.vue")])])])]),t("p",[t("strong",[s._v("ルーティング概要")])]),t("p",[t("code",{pre:!0},[s._v("<router-link>")]),s._v("で "),t("code",{pre:!0},[s._v("ProfileArticles")]),s._v("、"),t("code",{pre:!0},[s._v("ProfileFavorited")]),s._v(" に飛ばすリンクを設定し、"),t("code",{pre:!0},[s._v("<router-view>")]),s._v("で表示する仕組み。")]),t("p",[t("strong",[s._v("認証状態に依存する画面表示")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<div v-if="isCurrentUser()">\n  <router-link\n    class="btn btn-sm btn-outline-secondary action-btn"\n    :to="{ name: \'settings\' }"\n  >\n    ...\n  </router-link>\n</div>\n<div v-else>\n  <button\n    class="btn btn-sm btn-secondary action-btn"\n    v-if="profile.following"\n    @click.prevent="unfollow()"\n  >\n    ...\n  </button>\n  <button\n    class="btn btn-sm btn-outline-secondary action-btn"\n    v-if="!profile.following"\n    @click.prevent="follow()"\n  >\n    ...\n  </button>\n</div>\n')])]),t("p",[t("code",{pre:!0},[s._v('<div v-if="isCurrentUser()">')]),s._v("を使用することで、ログイン中のユーザかどうかで表示画面が変わる実装となっている。"),t("code",{pre:!0},[s._v('v-if="profile.following"')]),s._v("部分も同様で、フォローしているかどうかで表示画面が変わる。")]),t("p",[t("strong",[s._v("mounted()を使用した初期化処理")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" {\n  FETCH_PROFILE,\n  FETCH_PROFILE_FOLLOW,\n  FETCH_PROFILE_UNFOLLOW\n} "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/store/actions.type"')]),s._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  ...\n  mounted() {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$store.dispatch(FETCH_PROFILE, "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$route.params);\n  },\n  ...\n  watch: {\n    $route(to) {\n      "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$store.dispatch(FETCH_PROFILE, to.params);\n    }\n  }\n};      \n\n")])]),t("p",[s._v("初期化時に"),t("code",{pre:!0},[s._v("mounted()")]),s._v("で、ページのユーザ名をパラメータから取得している。")]),t("p",[s._v("Vue.jsではパラメータが "),t("code",{pre:!0},[s._v("#/@hoge")]),s._v(" から "),t("code",{pre:!0},[s._v("#/@huga")]),s._v(" へ遷移するときに"),t("strong",[s._v("同じコンポーネントインスタンスが再利用される")]),s._v("ので"),t("code",{pre:!0},[s._v("mounted()")]),s._v("が実行されない。そこで、"),t("code",{pre:!0},[s._v("watch: $route(to){...}")]),s._v("を使用して、パラメータの検知をおこなっている。"),t("a",{attrs:{href:"https://router.vuejs.org/ja/guide/essentials/dynamic-matching.html#%E3%83%8F%E3%82%9A%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E5%A4%89%E6%9B%B4%E3%81%AE%E6%A4%9C%E7%9F%A5"}},[s._v("参考")])]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("ProfileArticles.vue")]),s._v("、"),t("code",{pre:!0},[s._v("ProfileFavorited.vue")])])])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<template>\n  <div class="profile-page">\n    <RwvArticleList :author="author" :items-per-page="5"></RwvArticleList>\n    \x3c!--\n    <RwvArticleList :favorited="favorited" :items-per-page="5">\n    </RwvArticleList>\n    --\x3e\n  </div>\n</template>\n')])]),t("p",[t("code",{pre:!0},[s._v("template")]),s._v("のはどれも似た構成。"),t("code",{pre:!0},[s._v("@/components/ArticleList")]),s._v("を呼び、属性 ( author, favorited )を変えているだけ。")]),t("h4",[s._v("🔖/ views / Article.vue")]),t("p",[t("strong",[s._v("ナビゲーションガードを用いたデータ取得")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" store "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/store"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { FETCH_ARTICLE, FETCH_COMMENTS } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/store/actions.type"')]),s._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//...")]),s._v("\n  beforeRouteEnter(to, "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next) {\n    "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v(".all([\n      store.dispatch(FETCH_ARTICLE, to.params.slug),\n      store.dispatch(FETCH_COMMENTS, to.params.slug)\n    ]).then("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n      next();\n    });\n  }\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//...")]),s._v("\n}\n")])]),t("p",[t("code",{pre:!0},[s._v("beforeRouteEnter()")]),s._v("を用いて、"),t("code",{pre:!0},[s._v("FETCH_ARTICLE")]),s._v("、"),t("code",{pre:!0},[s._v("FETCH_COMMENTS")]),s._v("を呼ぶ。"),t("code",{pre:!0},[s._v("article")]),s._v("と"),t("code",{pre:!0},[s._v("comment")]),s._v("の最新を取得し"),t("code",{pre:!0},[s._v("state")]),s._v("を更新する。")]),t("p",[s._v("https://router.vuejs.org/ja/guide/advanced/navigation-guards.html#%E3%83%AB%E3%83%BC%E3%83%88%E5%8D%98%E4%BD%8D%E3%82%AB%E3%82%99%E3%83%BC%E3%83%88%E3%82%99")]),t("p",[t("strong",[s._v("v-htmlを用いた画面表示")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-html")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"parseMarkdown(article.body)"')]),s._v(">")]),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" marked "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"marked"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    parseMarkdown(content) {\n      "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" marked(content);\n    }\n  }\n}\n")])]),t("p",[t("code",{pre:!0},[s._v("marked")]),s._v("はマークダウン解析ツール、htmlを返すため、"),t("code",{pre:!0},[s._v("v-html")]),s._v("ディレクティブを使用している。")]),t("p",[s._v("https://www.npmjs.com/package/marked")]),t("h4",[s._v("🔖/ views / ArticleEdit.vue")]),t("p",[t("strong",[s._v("ナビゲーションガードを用いたデータ取得")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// [/editor/:slug] => [/editor] の場合、エディタを空にして表示する。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// beforeRouteUpdateは、パラメータが変わったタイミングでも実行される。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" beforeRouteUpdate(to, "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next) {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" store.dispatch(ARTICLE_RESET_STATE);\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" next();\n},\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// [/editor] の場合、下記のifがfalseになり、実行されない。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// [/editor/:slug] の場合、下記のifがtrueになり、実行される。 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" beforeRouteEnter(to, "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next) {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" store.dispatch(ARTICLE_RESET_STATE);\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (to.params.slug !== "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("undefined")]),s._v(") {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" store.dispatch(\n      FETCH_ARTICLE,\n      to.params.slug,\n      to.params.previousArticle\n    );\n  }\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" next();\n},\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// [/editor/:slug] から去るときエディタを空にする。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" beforeRouteLeave(to, "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next) {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" store.dispatch(ARTICLE_RESET_STATE);\n  next();\n},\n")])]),t("p",[s._v("ルートが変更したら実行される"),t("strong",[s._v("ナビゲーションガード")]),s._v("で制御する。"),t("code",{pre:!0},[s._v("ARTICLE_RESET_STATE")]),s._v("で記事エディタを空に更新するが、"),t("code",{pre:!0},[s._v("/editor/slug")]),s._v("のような場合は、元記事が記載されたまま表示する。")]),t("p",[s._v("※ ちなみに上記のナビゲーションガードは、パラメータが変わったタイミングでは実行されないので、 "),t("code",{pre:!0},[s._v("/editor")]),s._v(" から"),t("code",{pre:!0},[s._v("/editor/:slug")]),s._v("に遷移した場合、元記事が取得できない。")]),t("p",[s._v("参考：https://tsudoi.org/weblog/5738/")]),t("p",[s._v("参考：https://router.vuejs.org/ja/guide/advanced/navigation-guards.html")]),t("p",[t("strong",[s._v("タグ登録処理")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-vue"}},[s._v('<template>\n  ... \n  <input\n     type="text"\n     class="form-control"\n     placeholder="Enter tags"\n     v-model="tagInput"\n     @keypress.enter.prevent="addTag(tagInput)"\n  />\n  <div class="tag-list">\n    <span\n      class="tag-default tag-pill"\n      v-for="(tag, index) of article.tagList"\n      :key="tag + index"\n    >\n \t  <i class="ion-close-round" @click="removeTag(tag)"> </i>\n      {{ tag }}\n\t</span>\n  </div>\n  ...\n</template>\n')])]),t("p",[t("code",{pre:!0},[s._v('@keypress.enter.prevent="addTag(tagInput)"')]),s._v("のように、Enter押下時にタグ登録処理を行う実装となっている。")]),t("h3",[s._v("📖 /components")]),t("h4",[s._v("🔖/ components / TheHeader.vue")]),t("p",[s._v("ヘッダを表示するコンポーネント。")]),t("p",[t("strong",[s._v("認証状態に応じた画面表示")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ul")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-if")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"!isAuthenticated"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"nav navbar-nav pull-xs-right"')]),s._v(">")]),s._v("\n  ....    \n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ul")]),s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ul")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"nav navbar-nav pull-xs-right"')]),s._v(">")]),s._v("\n  ....\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ul")]),s._v(">")]),s._v("\n")])]),t("p",[s._v("認証状態によって表示する画面を"),t("code",{pre:!0},[s._v("v-if")]),s._v("で切り替えている。")]),t("p",[t("strong",[s._v("router-linkのパラメータ指定")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("router-link")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"nav-link"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("active-class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"active"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("exact")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":to")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("\"{\n    name: 'profile',\n    params: { username: currentUser.username }\n   }\"")]),s._v("\n>")]),s._v("\n  {{ currentUser.username }}\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("router-link")]),s._v(">")]),s._v("\n")])]),t("p",[t("code",{pre:!0},[s._v("<router-link>")]),s._v("では"),t("code",{pre:!0},[s._v(':to="{params:{...}}')]),s._v("でパラメータを指定することができる。")]),t("p",[s._v("https://router.vuejs.org/ja/api/#to")]),t("h4",[s._v("🔖 / components / VTag.vue")]),t("p",[s._v("タグを表示するコンポーネント。")]),t("p",[t("strong",[s._v("v-text を用いた画面出力")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("router-link")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":to")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"homeRoute"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"className"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-text")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"name"')]),s._v(">")]),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("router-link")]),s._v(">")]),s._v("\n")])]),t("p",[t("code",{pre:!0},[s._v('v-text="name"')]),s._v("は"),t("code",{pre:!0},[s._v("{{ name }}")]),s._v("と同じ")]),t("p",[t("strong",[s._v("propsの型指定")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" { \n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("props")]),s._v(": {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": {\n      "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("String")]),s._v(",\n      "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("required")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n    },\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("className")]),s._v(": {\n      "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("String")]),s._v(",\n      "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("default")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"tag-pill tag-default"')]),s._v("\n    }\n  }\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n}\n")])]),t("p",[t("code",{pre:!0},[s._v("props")]),s._v("では、型の指定（type）、必須項目指定（required）、デフォルト値（default）などプロパティの型を指定できる。以降で説明するコンポーネントの"),t("code",{pre:!0},[s._v("props")]),s._v("においても、型の指定を必ず行っていた。")]),t("p",[s._v("https://jp.vuejs.org/v2/guide/components-props.html#%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%81%AE%E5%9E%8B")]),t("h4",[s._v("🔖 / components / ArticleMeta.vue 周辺")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("ArticleMeta.vue")])])])]),t("p",[s._v("記事作成者の情報などで構成されるコンポーネント。")]),t("p",[t("strong",[s._v("フィルタの使用")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"date"')]),s._v(">")]),s._v("{{ article.createdAt | date }}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n")])]),t("p",[s._v("main.jsで定義したフィルターが使用されている。")]),t("p",[t("strong",[s._v("子コンポーネントでの制御")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("rwv-article-actions")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-if")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"actions"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":article")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"article"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":canModify")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"isCurrentUser()"')]),s._v("\n>")]),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("rwv-article-actions")]),s._v(">")]),s._v("\n")])]),t("p",[s._v("フォロー、いいねボタンは"),t("code",{pre:!0},[s._v("ArticleActions")]),s._v("コンポーネントで制御している。")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("ArtcleActions.vue")])])])]),t("p",[s._v("フォローやいいねボタンを構成するコンポーネント")]),t("p",[t("strong",[s._v("ユーザ状態に応じた画面表示")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-if")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"canModify"')]),s._v(">")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!-- Edit Article, DeleteArticleボタンが表示 --\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-else")]),s._v(">")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!-- Follow, Favoriteボタンが表示 --\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n")])]),t("p",[s._v("ユーザが記事の作成者か否かで表示画面を変えている。")]),t("p",[s._v("また、classを変えるなどの見た目の変更は"),t("code",{pre:!0},[s._v("computed")]),s._v("、 ボタン押下時の処理は"),t("code",{pre:!0},[s._v("methods")]),s._v("で行う。")]),t("h4",[s._v("🔖 / components / CommentEditor.vue 周辺")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("CommentEditor.vue")])])])]),t("p",[s._v("記事に対するコメントフォームを構成するコンポーネント。")]),t("p",[t("strong",[s._v("フォームの実装")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("RwvListErrors")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":errors")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"errors"')]),s._v(" />")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("form")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"card comment-form"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@submit.prevent")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"onSubmit(slug, comment)"')]),s._v(">")]),s._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("methods: {\n  onSubmit(slug, comment) {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$store\n      .dispatch(COMMENT_CREATE, { slug, comment })\n      .then("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n         "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".comment = "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(";\n         "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".errors = {};\n      })\n      .catch("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ response }")]),s._v(") =>")]),s._v(" {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".errors = response.data.errors;\n      });\n  }\n}\n")])]),t("p",[s._v("フォームのPostボタンを押下すると、"),t("code",{pre:!0},[s._v("COMMENT_CREATE")]),s._v("が実行される。この処理が失敗すると、"),t("code",{pre:!0},[s._v("RwvListErrors")]),s._v("部分でエラーメッセージが表示される。")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("ListError.vue")])])])]),t("p",[t("code",{pre:!0},[s._v("errors")]),s._v("オブジェクトを受け取った時に、エラーメッセージを画面に表示するコンポーネント。")]),t("h4",[s._v("🔖 / components / Comment.vue")]),t("p",[s._v("コメント表示のコンポーネント。")]),t("p",[t("strong",[s._v("削除イベント")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-if")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"isCurrentUser"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"mod-options"')]),s._v(">")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("i")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ion-trash-a"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"destroy(slug, comment.id)"')]),s._v(">")]),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("i")]),s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("computed: {\n  isCurrentUser() {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".currentUser.username && "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".comment.author.username) {\n      "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".comment.author.username === "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".currentUser.username;\n    }\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(";\n  },\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n}\n")])]),t("p",[t("code",{pre:!0},[s._v('@click="destroy(slug, comment.id)"')]),s._v("はクリックイベントで、コメントを削除する処理。"),t("code",{pre:!0},[s._v("isCurretntUser")]),s._v("は現在のユーザと著者が同じかどうかのフラグで、同じ場合はこの削除ボタンを表示する。")]),t("h4",[s._v("🔖 / components / ListErrors.vue")]),t("p",[t("code",{pre:!0},[s._v("errors")]),s._v("オブジェクトを受け取った時に、エラーメッセージを画面に表示するコンポーネント。"),t("code",{pre:!0},[s._v("CommentEditor.vue")]),s._v("でも使用している。")]),t("h4",[s._v("🔖 / components / ArticleList.vue")]),t("p",[s._v("記事プレビュー一覧を表示するコンポーネント。")]),t("p",[s._v("大まかな処理の流れは、"),t("code",{pre:!0},[s._v("listConfig")]),s._v("に記事情報を持たせて、"),t("code",{pre:!0},[s._v("currentpage")]),s._v("、 "),t("code",{pre:!0},[s._v("type")]),s._v("、 "),t("code",{pre:!0},[s._v("author")]),s._v("、 "),t("code",{pre:!0},[s._v("tag")]),s._v("、 "),t("code",{pre:!0},[s._v("favorited")]),s._v("を"),t("code",{pre:!0},[s._v("watch")]),s._v("で監視し、変更があったら"),t("code",{pre:!0},[s._v("fetchArticle()")]),s._v("で新しい記事の取得。である。")]),t("h4",[s._v("🔖 / components / VArticlePreview.vue 周辺")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("VArticlePreview.vue")])])])]),t("p",[s._v("記事プレビューを表示するコンポーネント。")]),t("p",[t("code",{pre:!0},[s._v("ArticleMeta.vue")]),s._v("と"),t("code",{pre:!0},[s._v("TagList.vue")]),s._v("コンポーネントを使用している。")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("TagList.vue")])])])]),t("p",[s._v("タグ一覧を表示するコンポーネント。")]),t("h4",[s._v("🔖 / components / VPagination.vue")]),t("p",[s._v("ページ割りの表示をするコンポーネント。")]),t("p",[t("strong",[s._v("クラスのバインディング")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-for")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"page in pages"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":data-test")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"`page-link-${page}`"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":key")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"page"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"paginationClass(page)"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click.prevent")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"changePage(page)"')]),s._v("\n>")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"page-link"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("href")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("v-text")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"page"')]),s._v(" />")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v(">")]),s._v("\n")])]),t("p",[t("code",{pre:!0},[s._v(':class="paginationClass(page)"')]),s._v("で現在のページと一致していたら"),t("code",{pre:!0},[s._v("active-class")]),s._v("をつけ、表示デザインを変える。")]),t("p",[t("strong",[s._v("$emitを使用した親コンポーネントへのイベント通知")])]),t("p",[s._v("ページ割りのボタンが押下されたら、"),t("code",{pre:!0},[s._v('@click.prevent="changePage(page)"')]),s._v("を実行する。")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("changePage(goToPage) {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (goToPage === "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".currentPage) "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(";\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$emit("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"update:currentPage"')]),s._v(", goToPage);\n},\n")])]),t("p",[s._v("親コンポーネント（"),t("code",{pre:!0},[s._v("ArticleList.vue")]),s._v("）では、以下のようにコンポーネントを使用している。")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("VPagination")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":pages")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"pages"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":currentPage.sync")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"currentPage"')]),s._v(" />")]),s._v("\n")])]),t("p",[t("code",{pre:!0},[s._v(".sync")]),s._v("修飾子をつけることで、子コンポーネントから"),t("code",{pre:!0},[s._v("this.$emit('update:currentPage', goToPage)")]),s._v(" により親に通知することができる。（親は "),t("code",{pre:!0},[s._v("update:prop名")]),s._v("のイベントを監視) "),t("a",{attrs:{href:"https://jp.vuejs.org/v2/guide/components-custom-events.html#sync-%E4%BF%AE%E9%A3%BE%E5%AD%90"}},[s._v("参照1【Vue】知っておきたい .sync修飾子のすゝめ")]),s._v("、"),t("a",{attrs:{href:"https://jp.vuejs.org/v2/guide/components-custom-events.html#sync-%E4%BF%AE%E9%A3%BE%E5%AD%90"}},[s._v("参考2_公式")])]),t("h3",[s._v("📖 /store")]),t("h4",[s._v("🔖 / store / index.js")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" Vue "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" Vuex "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vuex"')]),s._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" home "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./home.module"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" auth "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./auth.module"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" article "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./article.module"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" profile "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./profile.module"')]),s._v(";\n\nVue.use(Vuex);\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Vuex.Store({\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("modules")]),s._v(": {\n    home,\n    auth,\n    article,\n    profile\n  }\n});\n")])]),t("p",[s._v("storeの中が膨大になるのを防ぐため、複数のファイルで管理する。分割のために"),t("code",{pre:!0},[s._v("modules")]),s._v("を使用する。")]),t("h4",[s._v("🔖 / store / .modules.js")]),t("p",[t("strong",[s._v("全体構成")])]),t("p",[t("code",{pre:!0},[s._v(".modules.js")]),s._v("は共通して以下の4つを"),t("code",{pre:!0},[s._v("export")]),s._v("している。"),t("a",{attrs:{href:"https://vuex.vuejs.org/ja/"}},[s._v("参考：Vuex公式")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  state,\t　  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 状態管理利を行う対象")]),s._v("\n  actions,\t\t"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 非同期処理を行う。mutationsを呼ぶ。")]),s._v("\n  mutations,    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// stateの状態を変更する")]),s._v("\n  getters       "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// stateを取得する")]),s._v("\n};\n")])]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("auth.modules.js")])])])]),t("p",[t("strong",[s._v("ファイルの分割")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" ApiService "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/common/api.service"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" JwtService "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/common/jwt.service"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" {\n  LOGIN,\n  LOGOUT,\n  REGISTER,\n  CHECK_AUTH,\n  UPDATE_USER\n} "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./actions.type"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { SET_AUTH, PURGE_AUTH, SET_ERROR } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./mutations.type"')]),s._v(";\n")])]),t("p",[s._v("APIおよびJWTの処理は共通処理として切り出している。また、"),t("code",{pre:!0},[s._v("action")]),s._v("と"),t("code",{pre:!0},[s._v("mutation")]),s._v("で使用する関数は、"),t("code",{pre:!0},[s._v(".type")]),s._v("として別ファイルで定義している。")]),t("p",[t("strong",[s._v("Boolean型へのキャスト")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" state = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("errors")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("user")]),s._v(": {},\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("isAuthenticated")]),s._v(": !!JwtService.getToken()\n};\n")])]),t("p",[t("code",{pre:!0},[s._v("isAuthenticated: !!JwtService.getToken()")]),s._v("の"),t("code",{pre:!0},[s._v("!!")]),s._v("は二重否定を行い、Boolean型にキャストする処理。")]),t("p",[t("strong",[s._v("getters")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" getters = {\n  currentUser(state) {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" state.user;\n  },\n  isAuthenticated(state) {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" state.isAuthenticated;\n  }\n};\n")])]),t("p",[s._v("ユーザ状態と認証状態を返す。")]),t("p",[t("strong",[s._v("actions, mutations")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" actions = {\n  [LOGIN](context, credentials) {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve")]),s._v(" =>")]),s._v(" {\n      ApiService.post("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"users/login"')]),s._v(", { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("user")]),s._v(": credentials })\n        .then("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ data }")]),s._v(") =>")]),s._v(" {\n          context.commit(SET_AUTH, data.user);\n          resolve(data);\n        })\n        .catch("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ response }")]),s._v(") =>")]),s._v(" {\n          context.commit(SET_ERROR, response.data.errors);\n        });\n    });\n  },\n  [LOGOUT](context) {\n    context.commit(PURGE_AUTH);\n  },\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" mutations = {\n  [SET_ERROR](state, error) {\n    state.errors = error;\n  },\n  [SET_AUTH](state, user) {\n    state.isAuthenticated = "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(";\n    state.user = user;\n    state.errors = {};\n    JwtService.saveToken(state.user.token);\n  },\n  [PURGE_AUTH](state) {\n    state.isAuthenticated = "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(";\n    state.user = {};\n    state.errors = {};\n    JwtService.destroyToken();\n  }\n};\n")])]),t("p",[s._v("APIを呼び、成功したら"),t("code",{pre:!0},[s._v("SET_AUTH")]),s._v("、失敗したら"),t("code",{pre:!0},[s._v("SET_ERROR")]),s._v("、ログアウト時は"),t("code",{pre:!0},[s._v("PURGE_AUTH")]),s._v("と、"),t("code",{pre:!0},[s._v("mutation")]),s._v("にコミットする。")]),t("h3",[s._v("📖 /common")]),t("h4",[s._v("🔖 / common / .service.js")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("api.service.js")])])])]),t("p",[t("strong",[s._v("axios, vue-axiosの使用")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" Vue "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" axios "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"axios"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" VueAxios "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue-axios"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" JwtService "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/common/jwt.service"')]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { API_URL } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@/common/config"')]),s._v(";\n")])]),t("p",[t("code",{pre:!0},[s._v("axios")]),s._v("、"),t("code",{pre:!0},[s._v("vue-axios")]),s._v("を使用している。"),t("a",{attrs:{href:"https://www.npmjs.com/package/vue-axios"}},[s._v("参考 vue-axios")])]),t("p",[s._v("トークンの処理、ベースURLの管理は別ファイルに分離している。")]),t("p",[t("strong",[s._v("処理の分割")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" ApiService = {\n  init() {"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**/},\n  setHeader() {/**/")]),s._v("},  \n    \n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// http method")]),s._v("\n  query(resource, params) {"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('/**/},\n  get(resource, slug = "") {/**/')]),s._v("},\n  post(resource, params) {"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**/},\n  update(resource, slug, params) {/**/")]),s._v("},\n  put(resource, params) {"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**/},\n  delete(resource) {/**/")]),s._v("}\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" ApiService;\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" TagsService = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("get")]),s._v("() {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" ApiService.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"tags"')]),s._v(");\n  }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" ArticlesService = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" CommentsService = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" FavoriteService = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n};\n")])]),t("p",[s._v("ファイルの中でも処理の分割を行っている。"),t("code",{pre:!0},[s._v("ApiService")]),s._v("にて「初期化、ヘッダの設定、HTTP通信の基本処理」がまとまっている。それらを用いて"),t("code",{pre:!0},[s._v("TagService")]),s._v("、"),t("code",{pre:!0},[s._v("ArticlesService")]),s._v("など、具体的な処理を実装していることがわかる。")]),t("ul",[t("li",[t("strong",[t("code",{pre:!0},[s._v("jwt.service.js")])])])]),t("p",[t("strong",[s._v("ローカルストレージを用いたトークン管理")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" ID_TOKEN_KEY = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"id_token"')]),s._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" getToken = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("window")]),s._v(".localStorage.getItem(ID_TOKEN_KEY);\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" saveToken = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("token")]),s._v(" =>")]),s._v(" {\n  "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("window")]),s._v(".localStorage.setItem(ID_TOKEN_KEY, token);\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" destroyToken = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n  "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("window")]),s._v(".localStorage.removeItem(ID_TOKEN_KEY);\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" { getToken, saveToken, destroyToken };\n")])]),t("p",[s._v("ローカルストレージでトークンを管理している。")]),t("p",[s._v("※ ローカルストレージでトークンを管理するのはセキュリティ上よくないと聞いたことがあるが、どうなのだろうか？要調査")]),t("p",[t("a",{attrs:{href:"https://developer.mozilla.org/ja/docs/Web/API/Window/localStorage"}},[s._v("参考 MDN localStrage")])]),t("h4",[s._v("🔖 / common / .filter.js")]),t("p",[t("code",{pre:!0},[s._v("main.js")]),s._v("にて"),t("code",{pre:!0},[s._v("Vue.filter(xxx)")]),s._v("で使用している。")]),t("p",[s._v("関数で定義され、フィルターをかますと、戻り値の値に変換される。")]),t("p",[s._v("参考 : https://jp.vuejs.org/v2/guide/filters.html")]),t("h2",[s._v("所感")]),t("p",[s._v("Vue.jsに触れてこのリポジトリを見つけたときからいつかは理解したいと思っていたので、一通り理解できた？？？のでよかったです。")]),t("p",[s._v("記事を見直すと、トップダウンで書いてきたので、後から出てくる機能が前で使用されていてわかりにくいと感じました。記載の工夫が必要と感じました。ここまで書いたので、これからも定期的に読み直して、不足分は追記していこうと思います。")]),t("p",[s._v("コードリーディングした感想は、")]),t("ul",[t("li",[s._v("プログラミングと同じくらい、構成の設計は大切 "),t("ul",[t("li",[s._v("特に、処理は小さく分割する、機能をまとめることが重要")])])]),t("li",[s._v("リーディングを行う際、全体のファイルの関係性を整理すると、頭に入りやすい")]),t("li",[s._v("リポジトリを読むときは、Issuesを見るとヒントが隠れている")])]),t("p",[s._v("実はこれはVue2のプロジェクトで、数年間更新がされていないリポジトリです。今後は、学んだことを自分のアプリに適用すること。それと並行して、Vue3のReal World example appのリーディングに取り組んでいきたいです。")]),t("p",[s._v("https://github.com/mutoe/vue3-realworld-example-app")]),t("p",[s._v("https://codesandbox.io/s/x0til")])])}],p=r("2877"),v={},n=Object(p["a"])(v,t,a,!1,null,null,null);e["default"]=n.exports},e73d:function(s,e,r){s.exports=r.p+"img/folders.drawio.294d3fbe.svg"}}]);
//# sourceMappingURL=chunk-2f508e67.19d2b44b.js.map