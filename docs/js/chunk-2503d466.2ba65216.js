(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2503d466"],{"28c7":function(e,s,t){e.exports=t.p+"img/image-20210524183041800.992b246e.png"},aed7:function(e,s,t){"use strict";t.r(s);var r=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},v=[function(){var e=this,s=e.$createElement,r=e._self._c||s;return r("section",[r("h2",[e._v("Vue.jsとFirestoreでWebアプリを構築してみた[手順書]")]),r("p",[r("a",{attrs:{href:"https://savvyapps.com/blog/definitive-guide-building-web-app-vuejs-firebase"}},[e._v("参考にしたサイト")])]),r("p",[r("a",{attrs:{href:"https://github.com/savvyapps/SAVuegram"}},[e._v("github")])]),r("h2",[e._v("1. 初期設定")]),r("h3",[e._v("1-1. Vue CLIのインストールとプロジェクトの作成")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v("npm i -g @vue/cli\nvue create vue-app\n")])]),r("p",[r("img",{attrs:{src:t("28c7"),alt:"image-20210524183041800"}})]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v("cd vue-app\nnpm run serve\n")])]),r("h3",[e._v("1-2. vueファイルの作成")]),r("p",[e._v("以下を追加。views/ Login.vue, Dashboard.vue, Setting.vue")]),r("h3",[e._v("1-3. routerの修正")]),r("p",[e._v("Dashboardをルートに、login, settingsを追加")]),r("h3",[e._v("1-4. 不要ファイルの削除")]),r("p",[e._v("Home.vue, About.vue, assets/logo.png, components/HelloWorld.vue")]),r("h3",[e._v("1-5. App.vueの修正")]),r("p",[e._v("router-viewのみ")]),r("h2",[e._v("2. Firebaseのセットアップ")]),r("h3",[e._v("2-1. Firebaseプロジェクトの作成")]),r("p",[e._v("asia-northeast1 (東京) を選択")]),r("h3",[e._v("2-2. "),r("code",{pre:!0},[e._v("npm i firebase")])]),r("h3",[e._v("2-3. firebase.jsファイルの作成と設定")]),r("ul",[r("li",[e._v("firebase init　…　プロジェクト設定/マイアプリ　にある")]),r("li",[e._v("utils (db, auth)")]),r("li",[e._v("collection refs")]),r("li",[e._v("export utils / refs")])]),r("h3",[e._v("2-4. main.jsの修正")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e._v("firebase.auth().onAuthStateChanged("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("user")]),e._v("=>")]),e._v("{\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v("(user) {\n        "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// login now")]),e._v("\n    }\n})\n")])]),r("h2",[e._v("3. vue-routerの認証設定")]),r("h3",[e._v("3-1. "),r("code",{pre:!0},[e._v("import {auth} from '../firebase'")])]),r("h3",[e._v("3-2. metaオブジェクトの追加")]),r("p",[e._v("メタデータ：でーたのおまけみたいなもの")]),r("p",[r("code",{pre:!0},[e._v("meta:{requiresAuth: true}")]),e._v("で認証が必要なルートを指定するよう実装")]),r("h3",[e._v("3-3. ナビゲーションガードの設定")]),r("p",[r("code",{pre:!0},[e._v("router.beforeEach")]),e._v("ですべてのルートを通すナビゲーションガード（ページ遷移時に起動する処理）を実装")]),r("p",[e._v("loginしていない場合、/loginに飛ばす")]),r("h3",[e._v("3-4. 動作確認")]),r("h2",[e._v("4. Login Signup Viewの作成")]),r("h3",[e._v("4-1. scssファイルのインポート")]),r("p",[e._v("main.jsにインポートする")]),r("h3",[e._v("4-2. Login.vueにマークアップ")]),r("p",[e._v("マークアップ→バインディングするデータを定義→v.model.trim, @submit.preventを定義")]),r("p",[e._v("v.model.trim : 空白をなくす")]),r("p",[e._v("@submit.prevent : formの送信による再読み込み処理をなくす")]),r("h3",[e._v("4-3. login()の作成とvuexの作成")]),r("ul",[r("li",[r("p",[e._v("login()メソッドの作成（dispatchでactionにアクセス）")])]),r("li",[r("p",[e._v("action : login() → action : fetchUserProfile →mutation : setUserProfile → state : userProfile の流れでデータを格納")])])]),r("h3",[e._v("4-4. signupロジックのマークアップ")]),r("ul",[r("li",[e._v("loginフォームと並列にマークアップ→data()にデータを用意")]),r("li",[e._v("action : signup() → action : fetchUserProfile →mutation : setUserProfile → state : userProfile の流れでデータを格納")])]),r("h3",[e._v("4-5. ログインとサインアップの切り替え機能の追加")]),r("p",[e._v("v-ifで切り替え機能を追加")]),r("h3",[e._v("4-6. パスワードを忘れた場合のロジックの追加")]),r("ul",[r("li",[e._v("markup→データの追加→togglePasswordReset()メソッドの追加→PasswordReset.vueの作成→Login.vueにコンポーネントを登録")])]),r("h3",[e._v("4-7. firestoreセキュリティの実装")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[e._v("rules_version = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'2'")]),e._v(";\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /{"),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("document")]),e._v("=**} {\n      allow read, "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("write")]),e._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" \n      \t\trequest.time < timestamp.date("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("2021")]),e._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("6")]),e._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("17")]),e._v(");\n      allow write: "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v("\n      \t\trequest.auth.uid != "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("null")]),e._v(" \n    }\n  }\n}\n")])]),r("h2",[e._v("5. ナビゲーションの作成")]),r("h3",[e._v("5-1. SiteNav.vueファイルのマークアップ")]),r("p",[e._v("マークアップ（title, /, /setting logoutのリンク作成）")]),r("h3",[e._v("5-2. logout()の作成")]),r("p",[e._v("SiteNav.vueにlogout()を実装→store/index.jsを更新")]),r("h3",[e._v("5-3. App.vueの更新")]),r("p",[e._v("App.vueにSiteNav.vueを集約させる")]),r("p",[e._v("このままだと、ログインして更新するとナビゲーションが消えてしまう")]),r("h2",[e._v("6. ページリロードにおけるユーザ状態の処理")]),r("h3",[e._v("6-1. main.jsの更新（onAuthStateChanged）")]),r("h3",[e._v("6-2. store/index.jsの更新")]),r("p",[e._v("onAuthStateChangedはリロード時に起動する")]),r("p",[e._v("store.dispatch('fetchUserProfile', user)で常に'/'に飛ぶので修正する")]),r("h2",[e._v("7. ダッシュボードの作成")]),r("h3",[e._v("7-1. dashboard.vueへのマークアップ")]),r("h3",[e._v("7-2. 投稿を作成する機能の追加")]),r("p",[e._v("createPost()メソッドでvuex : actionのcreatePostを呼び出しpostCollectionsに登録")]),r("h3",[e._v("7-3. すべての投稿を取得しDOMにレンダリングする")]),r("ul",[r("li",[e._v("storeのexportのやりかたを変更 (fb.postsCollectionを切り出すため) "),r("ul",[r("li",[e._v("外出ししたfb.postsCollectionはpostsが更新されるたびに起動する")])])]),r("li",[e._v("momentをインストールしてv-forでレンダリング")])]),r("h3",[e._v("7-4. コメントの実装")]),r("ul",[r("li",[e._v("クリックイベントの追加")]),r("li",[e._v("CommentModal.vueの作成 "),r("ul",[r("li",[e._v("closeボタンは$emitで、投稿(post)と紐づけるためにpostをpropsで渡す。")]),r("li",[e._v("modalはv-ifで表示非表示を制御")])])]),r("li",[e._v("import")])]),r("h3",[e._v("7-5. 「いいね」の実装")]),r("ul",[r("li",[e._v("クリックイベントの追加、メソッドの追加、actionの追加")])]),r("h3",[e._v("7-6. 「コメント」の表示　●")]),r("ul",[r("li",[e._v("クリックイベントの追加、マークアップ、メソッドの追加")])]),r("h2",[e._v("8. 設定")]),r("h3",[e._v("8-1. Settings.vueでマークアップを設定")]),r("h3",[e._v("8-2. 基本データの設定")]),r("h3",[e._v("8-3. updateProfile()の実装")]),r("h3",[e._v("8-4. store /index.jsファイルにアクションメソッドupdateProfileを作成")]),r("h2",[e._v("その他ポイント")]),r("p",[e._v("store/index.js")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" store = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("new")]),e._v(" Vuex.Store({\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("state")]),e._v(": {\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("userProfile")]),e._v(": {},  \t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// ログインしたユーザ情報が格納される")]),e._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("posts")]),e._v(":[]\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// すべての投稿が格納される（ログインしたユーザ以外も含む）")]),e._v("\n  },\n")])])])}],a=t("2877"),p={},n=Object(a["a"])(p,r,v,!1,null,null,null);s["default"]=n.exports}}]);
//# sourceMappingURL=chunk-2503d466.2ba65216.js.map